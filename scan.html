<script>
  const urlParams = new URLSearchParams(window.location.search);
  const punto = urlParams.get('punto');
  const pin = urlParams.get('pin');
  const fecha = new Date();

  fetch("https://script.google.com/macros/s/AKfycbydz9JxnP7wTx_0xFTO1MSt9FrPTQ1vNMdG5uHKO4RM1BmnjuOa7_FWyZ8juDWAoSCUug/exec?" +
        `punto=${punto}&pin=${pin}&fecha=${fecha.toISOString()}`)
    .then(response => response.text())
    .then(data => {
      document.getElementById("mensaje").innerText = `Registro exitoso para el Punto ${punto}`;
      document.getElementById("siguienteBtn").style.display = 'inline-block';
    })
    .catch(err => {
      document.getElementById("mensaje").innerText = "Error al registrar el escaneo.";
      console.error(err);
    });

  document.getElementById("siguienteBtn").addEventListener("click", () => {
    window.location.href = `index.html?pin=${pin}`;
  });
</script>
